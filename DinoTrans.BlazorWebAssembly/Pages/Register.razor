@page "/register"
@inject NavigationManager navManager
@inject IJSRuntime js
@inject IUserService userClientService

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <EditForm Enhance Model="User" OnValidSubmit="HandleLogin">
                <DataAnnotationsValidator />
                <ValidationSummary />

                <div class="card">
                    <div class="card-header">Create an Account</div>
                    <div class="card-body">

                        <!-- First Name -->
                        <div class="form-group mb-3">
                            <input @bind="User.FirstName"
                                   class="form-control"
                                   placeholder="First Name" />
                        </div>

                        <!-- Last Name -->
                        <div class="form-group mb-3">
                            <input @bind="User.LastName"
                                   class="form-control"
                                   placeholder="Last Name" />
                        </div>

                        <!-- Email Address -->
                        <div class="form-group mb-3">
                            <input @bind="User.Email"
                                   class="form-control"
                                   type="email"
                                   placeholder="Email Address" />
                        </div>

                        <!-- Password -->
                        <div class="form-group mb-3">
                            <input @bind="User.Password"
                                   class="form-control"
                                   type="password"
                                   placeholder="Password" />
                        </div>

                        <!-- Confirm Password -->
                        <div class="form-group mb-3">
                            <input @bind="User.ConfirmPassword"
                                   class="form-control"
                                   type="password"
                                   placeholder="Confirm Password" />
                        </div>

                        <!-- Phone Number -->
                        <div class="form-group mb-3">
                            <input @bind="User.PhoneNumber"
                                   class="form-control"
                                   type="tel"
                                   placeholder="Phone Number" />
                        </div>

                        <!-- Address -->
                        <div class="form-group mb-3">
                            <input @bind="User.Address"
                                   class="form-control"
                                   placeholder="Address" />
                        </div>

                        <!-- Role -->
                        <div class="form-group mb-3">
                            <input @bind="User.Role"
                                   class="form-control"
                                   placeholder="Role"
                                   disabled />
                        </div>

                        <!-- Company Name -->
                        <div class="form-group mb-3">
                            <input @bind="User.CompanyName"
                                   class="form-control"
                                   placeholder="Company Name" />
                        </div>

                        <!-- Company Email -->
                        <div class="form-group mb-3">
                            <input @bind="User.CompanyEmail"
                                   class="form-control"
                                   type="email"
                                   placeholder="Company Email" />
                        </div>

                        <!-- Company Phone Number -->
                        <div class="form-group mb-3">
                            <input @bind="User.CompanyPhoneNumber"
                                   class="form-control"
                                   type="tel"
                                   placeholder="Company Phone Number" />
                        </div>

                        <!-- Company Role -->
                         <div class="form-group mb-3">
                             <select @bind="User.CompanyRole" class="form-control">
                                 <option value="Shipper">Shipper</option>
                                 <option value="Carrier">Carrier</option>
                             </select>
                         </div>

                        <!-- Company Address -->
                        <div class="form-group mb-3">
                            <input @bind="User.CompanyAddress"
                                   class="form-control"
                                   placeholder="Company Address" />
                        </div>

                    </div>
                    <div class="card-footer">
                        <button class="btn btn-primary float-end" type="submit">Register</button>
                    </div>
                </div>
            </EditForm>
        </div>
    </div>
</div>
 @code {
    public UserDTO User { get; set; } = new()
    {
        Role = Role.CompanyAdministrator
    };
    async Task HandleLogin()
    {
        var (flag, message) = await userClientService.CreateAccount(User);
        if (flag)
        {
            navManager.NavigateTo("/login", forceLoad: true);
            await js.InvokeVoidAsync("alert", message);
            return;
        }

    }
}